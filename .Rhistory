# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))+
# coord_map() +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(5,1))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))+
# coord_map() +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(1,1))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))+
# coord_map() +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.5,.5))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))+
# coord_map() +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.1,.2))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))+
# coord_map() +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
p
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
install.packages("ggiraph")
library(ggiraph)
shiny::runApp(appDir = system.file("shiny/crimes", package = "ggiraph"), display.mode = "showcase")
library(ggplot2)
library(mapdata)
library(ggiraph)
map.county <- map_data('county')
counties<- data.table(map.county)
library(shiny)
head(counties)
p<-ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) + #causes the tooltips to be even more off
geom_point_interactive(
aes(data_id = state, tooltip = paste0(subregion, " County, ", state), size = 3 )
)
p
head(counties)
counties$id<-rownames(counties)
p<-ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) + #causes the tooltips to be even more off
geom_point_interactive(
aes(data_id = id, tooltip = paste0(subregion, " County, ", state), size = 3 ))
p
p<-ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) + #causes the tooltips to be even more off
geom_point_interactive(
aes(data_id = id, tooltip = paste0(subregion, " County, ", region), size = 3 ))
p
ggiraph(code = print(p), width_svg = 8, height_svg = 8, selection_type = "multiple", zoom_max = 4,
hover_css = "fill:#FF3333;stroke:black;cursor:pointer;",
selected_css = "fill:#FF3333;stroke:black;")
ggiraph(code = print(p), width_svg = 8, height_svg = 8, selection_type = "single",
hover_css = "fill:#FF3333;stroke:black;cursor:pointer;",
selected_css = "fill:#FF3333;stroke:black;")
ggiraph(code = print(p), width_svg = 6, height_svg = 8, selection_type = "single",
hover_css = "fill:#FF3333;stroke:black;cursor:pointer;",
selected_css = "fill:#FF3333;stroke:black;")
runApp('nearpoint_example')
runApp('nearpoint_example')
runApp('nearpoint_example')
p<-ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) + #causes the tooltips to be even more off
geom_map_interactive(
aes(data_id = id, tooltip = paste0(subregion, " County, ", region), size = 3 ))
p<-ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_map(colour = "grey") +
coord_map("polyconic" ) + #causes the tooltips to be even more off
geom_map_interactive(
aes(data_id = id, tooltip = paste0(subregion, " County, ", region), size = 3 ))
# try out geom-map instead of polygon
p<-ggplot(counties) +
geom_map(map = counties, aes(map_id = id, fill = "grey"),
colour = "black") +
coord_map("polyconic" )
p
head(counties)
# try out geom-map instead of polygon
p<-ggplot() +
geom_map(map = counties, aes(map_id = id, fill = "grey"),
colour = "black") +
coord_map("polyconic" )
p
# county totals, all births
natality<- read.delim("wonder_data_extracts/Natality_12_15_county_totals_all_births_v2.txt",
header = TRUE, colClasses = "character") %>%
filter(Births != "Suppressed") %>%
mutate(Births = as.numeric(Births)) %>%
group_by(County.Code, County) %>%
mutate(cesarean_rate_all = round(Births/sum(Births),4)*100,
births_all = sum(Births)) %>%
filter(Delivery.Method == "Cesarean") %>%
select(-Notes, -Births, -Delivery.Method, -Delivery.Method.Code)
head(natality)
head(counties)
head(map.county)
counties<- data.table(map.county)
# try out geom-map instead of polygon
p<-ggplot(natality) +
geom_map(map = counties, aes(fill = cesarean_rate_all)) +
coord_map("polyconic" )
p
# try out geom-map instead of polygon
p<-ggplot(natality, aes(map_id = County.Code)) +
geom_map(map = counties, aes(fill = cesarean_rate_all)) +
coord_map("polyconic" )
p
head(map.county)
head(county.pop )
counties<- left_join(county.pop, counties, by=c("state" = "region",
"county" = "subregion"))
View(counties)
counties<- left_join(county.pop, map.count, by=c("state" = "region",
"county" = "subregion"))
counties<- left_join(county.pop, map.county, by=c("state" = "region",
"county" = "subregion"))
counties <- data.table(counties)
setkey(counties, fips)
# try out geom-map instead of polygon
p<-ggplot(natality, aes(map_id = fips)) +
geom_map(map = counties, aes(fill = cesarean_rate_all)) +
coord_map("polyconic" )
names(natality)
# try out geom-map instead of polygon
p<-ggplot(natality, aes(map_id = County.Code)) +
geom_map(map = counties, aes(fill = cesarean_rate_all)) +
coord_map("polyconic" )
# try out geom-map instead of polygon
p<-ggplot(natality, aes(map_id = County.Code)) +
geom_map(map = counties, aes(fill = "grey")) +
coord_map("polyconic" )
names(map)
counties <- data.table(counties)
# try out geom-map instead of polygon
p<-ggplot(natality, aes(map_id = County.Code)) +
geom_map(map = counties, aes(fill = "grey")) +
coord_map("polyconic" )
p
counties<- fortify(counties)
# try out geom-map instead of polygon
p<-ggplot(natality, aes(map_id = County.Code)) +
geom_map(map = counties, aes(fill = "grey")) +
coord_map("polyconic" )
# try out geom-map instead of polygon
p<-ggplot(natality) +
geom_map(map = counties,
map_id=fips,
aes(fill = "grey")) +
coord_map("polyconic" )
p
# try out geom-map instead of polygon
p<-ggplot(data =natality) +
geom_map(map = counties,
map_id=fips,
aes(fill = "grey")) +
coord_map("polyconic" )
# try out geom-map instead of polygon
p<-ggplot(data =natality)
# try out geom-map instead of polygon
p<-ggplot(data =natality) +
geom_map(map = counties,
map_id=fips,
aes(fill = "grey"))
library(ggcounty)
install.packages("ggcounty")
# try out geom-map instead of polygon
p<-ggplot() +
geom_map(data = natality,
map = counties,
map_id=fips,
aes(fill = "grey"),
color = "white") +
coord_map("polyconic" )
p
names(counties)
counties<- fortify(counties, region = fips)
# try out geom-map instead of polygon
p<-ggplot() +
geom_map(data = natality,
map = counties,
map_id=fips,
aes(fill = "grey"),
color = "white") +
coord_map("polyconic" )
# try out geom-map instead of polygon
p<-ggplot() +
geom_map(data = natality,
map = counties,
map_id=region,
aes(fill = "grey"),
color = "white") +
coord_map("polyconic" )
library(devtools)
install_github("hrbrmstr/ggcounty")
p<-ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) + #causes the tooltips to be even more off
geom_map_interactive(
aes(data_id = id, tooltip = paste0(subregion, " County, ", region), size = 3 ))
names(counties)
runApp('nearpoint_example')
p<- ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) +
geom_poly_interactive(data_id = fips, aes(tooltip = county))
p<- ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) +
geom_polygon_interactive(data_id = fips, aes(tooltip = county))
p<- ggplot(counties, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey") +
coord_map("polyconic" ) +
geom_polygon_interactive(aes(tooltip = county))
ggiraph(code = print(p),
hover_css = "fill:#FF3333;stroke:black;cursor:pointer;")
ggiraph(code = print(p))
head(map.df)
source('~/GitHub/delivery_method/delivery_method_app/app.R')
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))+
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = County_all_pop))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p))
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = County_all_pop))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p))
head(map.df)
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
# geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = County_all_pop))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
# geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = County_all_pop))+
scale_colour_gradient(low = "#999999", high = "orange")
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
# geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = County_all_pop))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
# geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
# geom_polygon_interactive(aes(tooltip = County_all_pop))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
# geom_polygon_interactive(aes(tooltip = County_all_pop))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
p
# plot the birth rate minus unidentified counties.
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = County_all_pop, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
head(map.df)
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = paste0(County_all_pop,
"<br>Population: ", population_all_pop,
"<br>C-section Rate: " cesarean_rate_all_pop)
, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = paste0(County_all_pop,
"<br>Population: ", population_all_pop,
"<br>C-section Rate: ", cesarean_rate_all_pop)
, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic" ) + #causes the tooltips to not work as well
geom_path(data = state_map, colour="black")+
# theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = paste0(County_all_pop,
"<br>Population: ", format(population_all_pop,big.mark=","),
"<br>C-section Rate: ", cesarean_rate_all_pop, "%")
, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
summary(map.df$long)
summary(map.df$lat)
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic",
xlim = c(-130, -60),ylim = c(23, 51))
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic",
xlim = c(-130, -60),ylim = c(23, 51))  +
geom_path(data = state_map, colour="black")+
# theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = paste0(County_all_pop,
"<br>Population: ", format(population_all_pop,big.mark=","),
"<br>C-section Rate: ", cesarean_rate_all_pop, "%")
, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
summary(map.df$long)
summary(map.df$lat)
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic",
xlim = c(-125, -66),ylim = c(24.9, 49.5))  +
geom_path(data = state_map, colour="black")+
# theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = paste0(County_all_pop,
"<br>Population: ", format(population_all_pop,big.mark=","),
"<br>C-section Rate: ", cesarean_rate_all_pop, "%")
, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic",
xlim = c(-120, -70),ylim = c(24.9, 49.5))  +
geom_path(data = state_map, colour="black")+
# theme_void() +
theme(legend.position = c(.15,.2)) +
geom_polygon_interactive(aes(tooltip = paste0(County_all_pop,
"<br>Population: ", format(population_all_pop,big.mark=","),
"<br>C-section Rate: ", cesarean_rate_all_pop, "%")
, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
p<- ggplot(map.df, aes(x=long, y=lat, group = group)) +
geom_polygon(colour = "grey" , aes(fill = cesarean_rate_all.x )) +
coord_map("polyconic",
xlim = c(-120, -70),ylim = c(24.9, 49.6))  +
geom_path(data = state_map, colour="black")+
# theme_void() +
theme(legend.position = c(.9,.2)) +
geom_polygon_interactive(aes(tooltip = paste0(County_all_pop,
"<br>Population: ", format(population_all_pop,big.mark=","),
"<br>C-section Rate: ", cesarean_rate_all_pop, "%")
, fill = cesarean_rate_all.x))+
scale_fill_gradientn("",colours=brewer.pal(9,"YlGnBu"))
# unfilled is unavailable due to population changes.
# grey/NA is an 'unidentified' county
ggiraph(code = print(p)) #takes a super long time to render...
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
sort(unique(map.df$state.y))
table(map.df$state.y)
head(counties)
# Define UI for application that draws a histogram
ui <- fluidPage(
# Make this height = 0 : div class="ggiraph-toolbar"
tags$div(class = "ggiraph-toolbar",
height = "0px"),
# Application title
titlePanel("Cesarean section rate"),
hr(),
h3("Rate as a factor of geographic location", align = "center"),
fluidRow(
column(2,
checkboxGroupInput(inputId = "select_state",
label = "Display: ",
choices = sort(unique(counties$region)))),
# column(width = 7, offset=3,
#        div(style="width:800px;height:600px;", ggiraphOutput("county_map")))
),
h4("All counties in a state with population
<100,000 are presented together (grey).
White counties have had population changes and therefore data are not available. "),
hr(),
h3("Rate as a factor of race and age of mother", align = "center"),
plotOutput("race_age_plot"),
h4("Each data point is a county. Only counties with population >100,000 are shown.
Horizontal line is the median, top and bottom of boxes are the 25th and 75th percentile,
respectively. The lines extend to ____, with data points indicating outliers. ")
)
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
library(shinyWidgets)
install.packages("shinyWidgets")
library(shinyWidgets)
source('~/GitHub/delivery_method/delivery_method_app/app.R')
source('~/GitHub/delivery_method/delivery_method_app/app.R')
